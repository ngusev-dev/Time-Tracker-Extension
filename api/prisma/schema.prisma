generator client {
  provider     = "prisma-client"
  output       = "../generated/prisma"
  moduleFormat = "cjs"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id           Int            @id @default(autoincrement())
  email        String         @unique
  password     String
  firstName    String
  lastName     String
  middleName   String?
  login        String
  createdAt    DateTime       @default(now())
  timerHistory TimerHistory[]
  userTimer    UserTimer?
  token        Token?

  @@map("users")
}

model UserTimer {
  id                 Int         @id @default(autoincrement())
  startTimer         DateTime?
  status             TimerStatus @default(NEW)
  userId             Int         @unique
  totalTimeInSeconds Float       @default(0)
  endTimer           DateTime?
  description        String?
  timerId            String      @unique @default(uuid()) @db.Uuid
  user               User        @relation(fields: [userId], references: [id])

  @@map("userTimers")
}

model TimerHistory {
  id                 Int      @id @default(autoincrement())
  startTimer         DateTime
  endTimer           DateTime
  userId             Int
  totalTimeInSeconds Float
  description        String?
  timerId            String   @db.Uuid
  user               User     @relation(fields: [userId], references: [id])

  @@map("timerHistories")
}

model session {
  sid    String   @id @db.VarChar
  sess   Json     @db.Json
  expire DateTime @db.Timestamp(6)

  @@index([expire], map: "IDX_session_expire")
}

model Token {
  id        Int         @default(autoincrement()) @id
  token     String
  expiresIn DateTime
  type      TokenType
  code      Int?

  user      User        @relation(fields: [userId], references: [id])
  userId    Int         @unique

  @@map("tokens")
}

enum TokenType {
  RESET_PASSWORD
}

enum TimerStatus {
  NEW
  WORKING
  PAUSE
}
